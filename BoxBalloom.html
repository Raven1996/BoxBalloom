<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Box Balloon</title>
<script type="text/javascript">
window.onload=function(){
	var canvas = document.getElementById('canvas');
    var context = canvas.getContext("2d");
	canvas.width = window.innerHeight-2;
    canvas.height = window.innerHeight-2;
	var WIDTH = canvas.height;
	var HEIGHT = canvas.height;

	var bnum=-1;
	var givennum=1000;
	var prcs=2000; //精度
	var que=new Array();

	var x0=0;
	var y0=0;
	var r0=prcs+1;
	while (givennum>0){ 
		var flag=1;
		bnum++;
		while (flag){
			if (y0+r0>0){
				r0-=1;
				x0=-prcs+r0;
				y0=-prcs+r0;
				}
			flag=false;
			while (Collide(x0,y0,r0)){
				x0+=1;
				if (x0>-prcs-y0 || x0+r0>0) {
					y0+=1;
					x0=y0;
				}
				if (y0+r0>0) {
					flag=true;
					break;
					}
				}
			
			}
		var aballoom1={
			x:x0,
			y:y0,
			r:r0
		}
		que.push(aballoom1);
		
		DrawCircle(que[bnum].x, que[bnum].y, que[bnum].r);
		givennum-=1;

		if (que[bnum].x!=0){
			DrawCircle(-que[bnum].x, que[bnum].y, que[bnum].r);
			DrawCircle(que[bnum].x, -que[bnum].y, que[bnum].r);
			DrawCircle(-que[bnum].x, -que[bnum].y, que[bnum].r);
			givennum-=3;
			if (que[bnum].x!=que[bnum].y){
				DrawCircle(que[bnum].y, que[bnum].x, que[bnum].r);
				DrawCircle(-que[bnum].y, que[bnum].x, que[bnum].r);
				DrawCircle(que[bnum].y, -que[bnum].x, que[bnum].r);
				DrawCircle(-que[bnum].y, -que[bnum].x, que[bnum].r);
				givennum-=4;
				}
			}
		}
	
	function Collide(x, y, r){
		for (var i=0; i<bnum; i++){
			var distance = Math.pow((que[i].x-x)*(que[i].x-x)+(que[i].y-y)*(que[i].y-y),0.5);
			if (distance<r+que[i].r){
				return true;
			}
		}
		return false;
	}
	
	function DrawCircle(x, y, r){
		context.fillStyle = "rgba(0, 0, 0, 0.618)";
		context.beginPath();
		context.arc(x*WIDTH/2/prcs+WIDTH/2, y*WIDTH/2/prcs+WIDTH/2, r*WIDTH/2/prcs, 0, Math.PI*2, false);
		context.closePath();
		context.fill();
	}
}
</script>

</head>
<body style="margin:0px;padding:0px;">
	<canvas id="canvas" width="640" height="640" style="border:1px solid #aaa;display:block;margin:0px auto;padding:0px;">
	Please try another browser.
	</canvas>
</body>
</html>